Nested XML handling with Spark example